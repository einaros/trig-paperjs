<!DOCTYPE html> 
<html>
    <head>
        <style>
            body {
                margin: 0;
                padding: 0;
                overflow: hidden;
            }
        </style>
        <script src="paper.js"></script>
        <script>
            window.onload = function() {
                var circleCenterPt = new paper.Point(200, 300);
                var circleRadius = 75;
                var sineWaveLength = 400;
                var cosWaveLength = 300;

                paper.setup(document.getElementById('canvas'));
                var sineWaveStep = sineWaveLength/360;
                var cosWaveStep = cosWaveLength/360;
                var angle = 0;
                
                var circle = new paper.Path.Circle(circleCenterPt, circleRadius);
                circle.strokeColor = 'blue';

                var xAxis = new paper.Path.Line(
                    new paper.Point(0, circleCenterPt.y),
                    new paper.Point(circleCenterPt.x + sineWaveLength, circleCenterPt.y));
                xAxis.strokeColor = 'gray';

                var yAxis = new paper.Path.Line(
                    new paper.Point(circleCenterPt.x, 0),
                    new paper.Point(circleCenterPt.x, 500));
                yAxis.strokeColor = 'gray';
                
                var marker = new paper.Path.Circle(new paper.Point(10, 10), 5);
                marker.strokeColor = 'blue';
                marker.fillColor = 'white';
                
                var sineWave = new paper.Path();
                sineWave.strokeColor = 'green';
                for (var i = 0; i < sineWaveLength/sineWaveStep; ++i) {
                    sineWave.add(new paper.Point(
                        circleCenterPt.x + i * sineWaveStep, 
                        circleCenterPt.y - Math.sin((angle + i) / 180 * Math.PI) * circleRadius));
                }
                var sineWaveMarker = new paper.Path.Line(
                    sineWave.segments[0].point.clone(),
                    sineWave.segments[0].point.clone());
                sineWaveMarker.strokeColor = 'black';
                sineWaveMarker.dashArray = [2, 2];
                
                var cosWave = new paper.Path();
                cosWave.strokeColor = 'green';
                for (var i = 0; i < cosWaveLength/cosWaveStep; ++i) {
                    cosWave.add(new paper.Point(
                        circleCenterPt.x + Math.cos((angle + i) / 180 * Math.PI) * circleRadius, 
                        circleCenterPt.y - i * cosWaveStep));
                }
                var cosWaveMarker = new paper.Path.Line(
                    cosWave.segments[0].point.clone(),
                    cosWave.segments[0].point.clone());
                cosWaveMarker.strokeColor = 'black';
                cosWaveMarker.dashArray = [2, 2];

                paper.view.draw();
                
                function redraw() {
                    var a = (angle++) / 180 * Math.PI;
                    marker.position.x = circleCenterPt.x + Math.cos(a) * circleRadius;
                    marker.position.y = circleCenterPt.y + Math.sin(a) * circleRadius;
                    
                    for (var i = sineWave.segments.length - 1; i > 0; --i) {
                        sineWave.segments[i].point.y = sineWave.segments[i - 1].point.y;
                    }
                    sineWave.segments[0].point.y = marker.position.y;
                    sineWaveMarker.segments[0].point = marker.position.clone();
                    sineWaveMarker.segments[1].point = sineWave.segments[0].point.clone();
                    
                    for (var i = cosWave.segments.length - 1; i > 0; --i) {
                        cosWave.segments[i].point.x = cosWave.segments[i - 1].point.x;
                    }
                    cosWave.segments[0].point.x = marker.position.x;
                    cosWaveMarker.segments[0].point = marker.position.clone();
                    cosWaveMarker.segments[1].point = cosWave.segments[0].point.clone();
                    
                    paper.view.draw();
                }
                
                setInterval(redraw, 1000/60);
            }
        </script>
    </head>
    <body>
        <canvas resize id="canvas">
    </body>
</html>